"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),mobx_1=require("mobx"),SecurityRequirement_1=require("./SecurityRequirement"),utils_1=require("../../utils"),Callback_1=require("./Callback"),Field_1=require("./Field"),RequestBody_1=require("./RequestBody"),Response_1=require("./Response");function isPayloadSample(e){return"payload"===e.lang&&e.requestBodyContent}exports.isPayloadSample=isPayloadSample;var isCodeSamplesWarningPrinted=!1,OperationModel=function(){function e(e,t,i,r,o){void 0===o&&(o=!1),Object.defineProperty(this,"parser",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"operationDefinition",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"absoluteIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:"operation"}),Object.defineProperty(this,"parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"externalDocs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"depth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ready",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"active",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"expanded",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"pointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"operationId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"httpVerb",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"deprecated",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"path",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"servers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"security",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extensions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isWebhook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),mobx_1.makeObservable(this),this.pointer=t.pointer,this.description=t.description,this.parent=i,this.externalDocs=t.externalDocs,this.deprecated=!!t.deprecated,this.httpVerb=t.httpVerb,this.deprecated=!!t.deprecated,this.operationId=t.operationId,this.path=t.pathName,this.isCallback=o,this.isWebhook=t.isWebhook,this.name=utils_1.getOperationSummary(t),this.isCallback?(this.security=(t.security||[]).map((function(t){return new SecurityRequirement_1.SecurityRequirementModel(t,e)})),this.servers=utils_1.normalizeServers("",t.servers||t.pathServers||[])):(this.id=utils_1.sanitizeItemId(void 0!==t.operationId?"operation/"+t.operationId:void 0!==i?i.id+this.pointer:this.pointer),this.security=(t.security||e.definition.security||[]).map((function(t){return new SecurityRequirement_1.SecurityRequirementModel(t,e)})),this.servers=utils_1.normalizeServers(e.definitionUrl,t.servers||t.pathServers||e.definition.servers||[])),r.showExtensions&&(this.extensions=utils_1.extractExtensions(t,r.showExtensions))}return Object.defineProperty(e.prototype,"activate",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.active=!0}}),Object.defineProperty(e.prototype,"deactivate",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.active=!1}}),Object.defineProperty(e.prototype,"toggle",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.expanded=!this.expanded}}),Object.defineProperty(e.prototype,"expand",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.parent&&this.parent.expand()}}),Object.defineProperty(e.prototype,"collapse",{enumerable:!1,configurable:!0,writable:!0,value:function(){}}),Object.defineProperty(e.prototype,"requestBody",{get:function(){return this.operationDefinition.requestBody&&new RequestBody_1.RequestBodyModel(this.parser,this.operationDefinition.requestBody,this.options,{operation:this})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"codeSamples",{get:function(){var e=this.operationDefinition["x-codeSamples"]||this.operationDefinition["x-code-samples"]||[];this.operationDefinition["x-code-samples"]&&!isCodeSamplesWarningPrinted&&(isCodeSamplesWarningPrinted=!0,console.warn('"x-code-samples" is deprecated. Use "x-codeSamples" instead'));var t=this.requestBody&&this.requestBody.content;if(t&&t.hasSample){var i=Math.min(e.length,this.options.payloadSampleIdx);e=tslib_1.__spreadArrays(e.slice(0,i),[{lang:"payload",label:"Payload",source:"",requestBodyContent:t}],e.slice(i))}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parameters",{get:function(){var e=this,t=utils_1.mergeParams(this.parser,this.operationDefinition.pathParameters,this.operationDefinition.parameters).map((function(t){return new Field_1.FieldModel(e.parser,t,e.pointer,e.options,void 0,{operation:e,type:"request"})}));return this.options.sortPropsAlphabetically?utils_1.sortByField(t,"name"):this.options.requiredPropsFirst?utils_1.sortByRequired(t):t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"responses",{get:function(){var e=this,t=!1;return Object.keys(this.operationDefinition.responses||[]).filter((function(e){return"default"===e||("success"===utils_1.getStatusCodeType(e)&&(t=!0),utils_1.isStatusCode(e))})).map((function(i){return new Response_1.ResponseModel(e.parser,i,t,e.operationDefinition.responses[i],e.options,{operation:e})}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"callbacks",{get:function(){var e=this;return Object.keys(this.operationDefinition.callbacks||[]).map((function(t){return new Callback_1.CallbackModel(e.parser,t,e.operationDefinition.callbacks[t],e.pointer,e.options)}))},enumerable:!0,configurable:!0}),tslib_1.__decorate([mobx_1.observable],e.prototype,"ready",void 0),tslib_1.__decorate([mobx_1.observable],e.prototype,"active",void 0),tslib_1.__decorate([mobx_1.observable],e.prototype,"expanded",void 0),tslib_1.__decorate([mobx_1.action],e.prototype,"activate",null),tslib_1.__decorate([mobx_1.action],e.prototype,"deactivate",null),tslib_1.__decorate([mobx_1.action],e.prototype,"toggle",null),tslib_1.__decorate([utils_1.memoize],e.prototype,"requestBody",null),tslib_1.__decorate([utils_1.memoize],e.prototype,"codeSamples",null),tslib_1.__decorate([utils_1.memoize],e.prototype,"parameters",null),tslib_1.__decorate([utils_1.memoize],e.prototype,"responses",null),tslib_1.__decorate([utils_1.memoize],e.prototype,"callbacks",null),e}();exports.OperationModel=OperationModel;
//# sourceMappingURL=Operation.js.map