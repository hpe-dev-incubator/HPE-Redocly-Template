"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),lunr=tslib_1.__importStar(require("lunr"));try{require("core-js/es/promise")}catch(e){}var Worker=function(){Object.defineProperty(this,"add",{enumerable:!0,configurable:!0,writable:!0,value:add}),Object.defineProperty(this,"done",{enumerable:!0,configurable:!0,writable:!0,value:done}),Object.defineProperty(this,"search",{enumerable:!0,configurable:!0,writable:!0,value:search}),Object.defineProperty(this,"toJS",{enumerable:!0,configurable:!0,writable:!0,value:toJS}),Object.defineProperty(this,"load",{enumerable:!0,configurable:!0,writable:!0,value:load}),Object.defineProperty(this,"dispose",{enumerable:!0,configurable:!0,writable:!0,value:dispose}),Object.defineProperty(this,"fromExternalJS",{enumerable:!0,configurable:!0,writable:!0,value:fromExternalJS})};exports.default=Worker;var builder,resolveIndex,index,store=[];function initEmpty(){(builder=new lunr.Builder).field("title"),builder.field("description"),builder.ref("ref"),builder.pipeline.add(lunr.trimmer,lunr.stopWordFilter,lunr.stemmer),index=new Promise((function(e){resolveIndex=e}))}lunr.tokenizer.separator=/\s+/,initEmpty();var expandTerm=function(e){return"*"+lunr.stemmer(new lunr.Token(e,{}))+"*"};function add(e,r,t){var i=store.push(t)-1,n={title:e.toLowerCase(),description:r.toLowerCase(),ref:i};builder.add(n)}function done(){return tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(e){return resolveIndex(builder.build()),[2]}))}))}function toJS(){return tslib_1.__awaiter(this,void 0,void 0,(function(){var e;return tslib_1.__generator(this,(function(r){switch(r.label){case 0:return e={store:store},[4,index];case 1:return[2,(e.index=r.sent().toJSON(),e)]}}))}))}function fromExternalJS(e,r){return tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(t){try{if(importScripts(e),!self[r])throw new Error("Broken index file format");load(self[r])}catch(e){console.error("Failed to load search index: "+e.message)}return[2]}))}))}function load(e){return tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(r){return store=e.store,resolveIndex(lunr.Index.load(e.index)),[2]}))}))}function dispose(){return tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(e){return store=[],initEmpty(),[2]}))}))}function search(e,r){return void 0===r&&(r=0),tslib_1.__awaiter(this,void 0,void 0,(function(){var t;return tslib_1.__generator(this,(function(i){switch(i.label){case 0:return 0===e.trim().length?[2,[]]:[4,index];case 1:return t=i.sent().query((function(r){e.trim().toLowerCase().split(/\s+/).forEach((function(e){if(1!==e.length){var t=expandTerm(e);r.term(t,{})}}))})),r>0&&(t=t.slice(0,r)),[2,t.map((function(e){return{meta:store[e.ref],score:e.score}}))]}}))}))}exports.add=add,exports.done=done,exports.toJS=toJS,exports.fromExternalJS=fromExternalJS,exports.load=load,exports.dispose=dispose,exports.search=search;
//# sourceMappingURL=SearchWorker.worker.js.map