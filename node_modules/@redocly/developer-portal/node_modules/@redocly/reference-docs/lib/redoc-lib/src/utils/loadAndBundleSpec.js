"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),bundle_1=require("@redocly/openapi-core/lib/bundle"),config_1=require("@redocly/openapi-core/lib/config/config"),swagger2openapi_1=require("swagger2openapi"),dom_1=require("./dom");function loadAndBundleDefinition(e){return tslib_1.__awaiter(this,void 0,void 0,(function(){var n,r,o;return tslib_1.__generator(this,(function(t){switch(t.label){case 0:return n=new config_1.Config({}),r={config:n,base:dom_1.IS_BROWSER?window.location.href:process.cwd()},dom_1.IS_BROWSER&&(n.resolve.http.customFetch=global.fetch),"object"==typeof e&&null!==e?r.doc=createParsedDocument(e):r.ref=e,[4,bundle_1.bundle(r)];case 1:return[2,void 0!==(o=t.sent().bundle.parsed).swagger?convertSwagger2OpenAPI(o):o]}}))}))}function createParsedDocument(e){return{source:{absoluteRef:""},parsed:e}}function convertSwagger2OpenAPI(e){return console.warn("[ReDoc Compatibility mode]: Converting OpenAPI 2.0 to OpenAPI 3.0"),e.paths||(e.paths={}),new Promise((function(n,r){return swagger2openapi_1.convertObj(e,{patch:!0,warnOnly:!0,text:"{}",anchors:!0},(function(e,o){if(e)return r(e);n(o&&o.openapi)}))}))}exports.loadAndBundleDefinition=loadAndBundleDefinition,exports.createParsedDocument=createParsedDocument,exports.convertSwagger2OpenAPI=convertSwagger2OpenAPI;
//# sourceMappingURL=loadAndBundleSpec.js.map