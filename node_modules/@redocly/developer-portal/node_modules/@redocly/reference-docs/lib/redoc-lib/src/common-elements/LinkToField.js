"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,tslib_1=require("tslib"),React=tslib_1.__importStar(require("react")),StoreBuilder_1=require("../components/StoreBuilder"),styled_components_1=tslib_1.__importDefault(require("../styled-components")),constants_1=require("../services/constants"),linkify_1=require("./linkify"),helpers_1=require("../../../services/history/helpers");exports.LinkToField=function(e){var n,i,t,o=React.useContext(StoreBuilder_1.StoreContext),r=React.useState(!1),l=r[0],s=r[1],a=(null==o?void 0:o.menu.history.linkForId(null===(i=e.field.deps.operation)||void 0===i?void 0:i.id))||"",p=helpers_1.constructFieldDeepFragment(e.field),c=o&&p?o.menu.history.generateDeepLink(p,a):null,u=o?((n={})[constants_1.SECTION_ATTR]=(null===(t=e.field.deps.operation)||void 0===t?void 0:t.id)+o.options.deepLinkPrefix+p,n.id=c&&c.split("#")[1]||void 0,n):null;return React.useEffect((function(){if(o&&u)return s(o.menu.history.currentId===u[constants_1.SECTION_ATTR]),o.menu.history.subscribe((function(e){s(e===u[constants_1.SECTION_ATTR])}))}),[null==o?void 0:o.menu.history,null==u?void 0:u[constants_1.SECTION_ATTR]]),p&&o&&c?React.createElement("a",tslib_1.__assign({className:e.className+(l?" active":""),href:c,onClick:function(e){return function(e,n,i){n.defaultPrevented||0!==n.button||linkify_1.isModifiedEvent(n)||(n.preventDefault(),e.replaceForField(i))}(o.menu.history,e,c),e.stopPropagation(),e.preventDefault(),o.options.onDeepLinkClick&&o.options.onDeepLinkClick(c),!1}},u),e.children):e.children||null},exports.ShareLinkToField=styled_components_1.default(exports.LinkToField)(templateObject_1||(templateObject_1=tslib_1.__makeTemplateObject(["\n  ","\n\n  & {\n    position: relative;\n    left: 0;\n\n    margin-left: calc(-12px - 4px);\n    padding-top: 10px;\n    margin-top: -10px;\n\n    .field-name:hover > &::before,\n    &:hover::before {\n      visibility: visible;\n    }\n  }\n\n  &.active::before {\n    visibility: visible;\n  }\n"],["\n  ","\n\n  & {\n    position: relative;\n    left: 0;\n\n    margin-left: calc(-12px - 4px);\n    padding-top: 10px;\n    margin-top: -10px;\n\n    .field-name:hover > &::before,\n    &:hover::before {\n      visibility: visible;\n    }\n  }\n\n  &.active::before {\n    visibility: visible;\n  }\n"])),linkify_1.linkifyMixin("&","12px"));
//# sourceMappingURL=LinkToField.js.map