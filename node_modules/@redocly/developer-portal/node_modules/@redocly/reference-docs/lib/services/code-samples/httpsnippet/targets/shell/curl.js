"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),util_1=require("util"),code_builder_1=require("../../helpers/code-builder"),shell_1=tslib_1.__importDefault(require("../../helpers/shell")),code_helpers_1=require("../../helpers/code-helpers"),utils_1=require("../../../../utils"),__1=require("../.."),utils_2=require("../../../../../utils");function getUrl(e){var t=e.fullUrl,a=void 0===t?"":t,s=e.pathParameters,r=void 0===s?{}:s;return code_helpers_1.parseUrlIntoOperands(a,r).map((function(e){var t;return"variable"===e.type?null!==(t=utils_2.getParameterValue("path",e.name))&&void 0!==t?t:":"+e.name:e.value})).join("")}var handler=function(e,t,a){var s,r,i=a.target,l=a.client,n=Object.assign({indent:"  ",short:!1,binary:!1},t),o=new code_builder_1.CodeBuilder({indentation:n.indent,lineJoin:n.indent?" \\\n"+n.indent:" "}),u=(null===(s=e.securityOAuth2ExtraCalls)||void 0===s?void 0:s.length)?new __1.HTTPSnippet(null===(r=e.securityOAuth2ExtraCalls)||void 0===r?void 0:r[0]).convert(i,l,tslib_1.__assign(tslib_1.__assign({},n),{withComments:!1})):"";if(o.push(0,"curl -i %s %s",n.short?"-X":"--request",e.method.toUpperCase()),e.basicAuth&&o.push(util_1.format("-u %s:%s",e.basicAuth.username,e.basicAuth.password)),o.push(util_1.format("%s%s",n.short?"":"--url ",shell_1.default.quote(getUrl(e)))),"HTTP/1.0"===e.httpVersion&&o.push(n.short?"-0":"--http1.0"),Object.keys(e.headersObj).sort().forEach((function(t){var a=util_1.format("%s: %s",t,e.headersObj[t]);o.push("%s %s",n.short?"-H":"--header",shell_1.default.quote(a))})),e.allHeaders.cookie&&o.push("%s %s",n.short?"-b":"--cookie",shell_1.default.quote(e.allHeaders.cookie)),e.postData)switch(utils_1.normalizeMimeType(e.postData.mimeType)){case"multipart/form-data":e.postData.params.map((function(e){var t;t=e.fileName?util_1.format("%s=@%s",e.name,e.fileName):util_1.format("%s=%s",e.name,e.value),o.push("%s %s",n.short?"-F":"--form",shell_1.default.quote(t))}));break;case"application/x-www-form-urlencoded":e.postData.params?e.postData.params.map((function(e){o.push("%s %s",n.binary?"--data-binary":n.short?"-d":"--data",shell_1.default.quote(util_1.format("%s=%s",e.name,e.value)))})):o.push("%s %s",n.binary?"--data-binary":n.short?"-d":"--data",shell_1.default.quote(e.postData.text));break;case"application/json":e.postData.jsonObj&&o.push("%s %s",n.binary?"--data-binary":n.short?"-d":"--data",code_helpers_1.addIndentation(shell_1.default.quote(JSON.stringify(e.postData.jsonObj,null,n.indent)),{level:1,indent:n.indent,firstLine:!1}));break;default:e.postData.text&&o.push("%s %s",n.binary?"--data-binary":n.short?"-d":"--data",code_helpers_1.addIndentation(shell_1.default.quote(e.postData.text),{level:1,indent:n.indent,firstLine:!1}))}return(n.withComments?"# Requires curl >= 7.2\n\n":"")+(u?u+"\n\n"+o.join():o.join())};exports.info={key:"curl",title:"curl",link:"http://curl.haxx.se/",description:"cURL is a command line tool and library for transferring data with URL syntax"},exports.default=handler;
//# sourceMappingURL=curl.js.map