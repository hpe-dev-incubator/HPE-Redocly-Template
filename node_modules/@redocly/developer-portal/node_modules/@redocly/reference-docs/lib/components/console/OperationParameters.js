"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var SchemaType,tslib_1=require("tslib"),React=tslib_1.__importStar(require("react")),utils_1=require("../../utils"),form_1=require("../common/form"),TextField_1=require("../common/TextField"),ParameterDropdown_1=require("./ParameterDropdown");!function(e){e.ARRAY="array",e.OBJECT="object"}(SchemaType=exports.SchemaType||(exports.SchemaType={}));var placeholder=function(e){return"("+e.schema.type+")"+(e.example?" "+e.example:"")};function safePush(e,a,r){e[a]||(e[a]=[]),e[a].push(r)}function orderParams(e){var a={};return e.forEach((function(e){safePush(a,e.in,e)})),a}var PARAM_PLACES=["path","query","cookie","header"];function createValidator(e){return function(a){if(e.required&&!a)return"Field is required";if(e.required&&e.schema.type===SchemaType.ARRAY&&Array.isArray(a)){if(a.length>(e.schema.rawSchema&&e.schema.rawSchema.maxItems||1/0))return"Too many items selected, maximum "+e.schema.rawSchema.maxItems;if(a.length<(e.schema.rawSchema&&e.schema.rawSchema.minItems||0)){var r=e.schema.rawSchema.minItems;return"You should select at least "+(1===r?r+" item":r+" items")}}}}function getInitialValue(e){if(e.schema.type===SchemaType.ARRAY){var a=e.schema.default||e.schema.example;if(!a&&e.schema.rawSchema.items){if(e.schema.rawSchema.items.default)return[e.schema.rawSchema.items.default];if(e.schema.rawSchema.items.example)return[e.schema.rawSchema.items.example]}return a||[]}return e.schema.default||e.schema.example}function OperationParameters(e){function a(r,t,m){var n,i=m?utils_1.dottedString(m,r.name):r.name,c=function(e){var a=e.oneOfType,r=e.type,t=e.items;return a||r===SchemaType.ARRAY&&(null==t?void 0:t.type)===SchemaType.OBJECT&&"Array of objects"}(r.schema);if(c&&console.warn('Unsupported parameter definition: "'+c+'"'),r.schema.type===SchemaType.OBJECT)return null===(n=r.schema.fields)||void 0===n?void 0:n.map((function(e){return a(e,t,i)}));var l=m?[t,m]:[r.in],o=utils_1.dottedString.apply(void 0,tslib_1.__spreadArrays(l,[r.name]));return React.createElement(form_1.FormControl,{key:o},React.createElement(form_1.FormLabel,{required:r.required},i,":"),c?React.createElement(form_1.FormWarning,null,"Unsupported field schema definition"):function(a,r){var t=React.useMemo((function(){return createValidator(r)}),[r]),m=e.values,n=Array.isArray(r.schema.enum)&&r.schema.enum.length?r.schema.enum:void 0,i=getInitialValue(r);return n?React.createElement(form_1.FormControl,null,React.createElement(ParameterDropdown_1.ParameterEnumDropdown,{initValue:i,paramEnum:n,field:a})):React.createElement(TextField_1.FormTextField,{fullWidth:!0,id:a,field:a,placeholder:placeholder(r),validate:t,initialValue:i||utils_1.get(m,a),validateOnBlur:!0,validateOnChange:!0})}(o,r))}var r=orderParams(e.operation.parameters||[]);return React.createElement(form_1.Table,null,PARAM_PLACES.map((function(e){return function(e,r){return r&&r.length?React.createElement(React.Fragment,{key:e},React.createElement(form_1.FormControl,null,React.createElement(form_1.GroupLabel,null," # ",e," parameters "),React.createElement("span",null,"Â ")),r.map((function(r){return a(r,e)}))):null}(e,r[e])})))}exports.OperationParameters=OperationParameters;
//# sourceMappingURL=OperationParameters.js.map