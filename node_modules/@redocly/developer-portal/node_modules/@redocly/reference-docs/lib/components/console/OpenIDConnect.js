"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),React=tslib_1.__importStar(require("react")),redoc_lib_1=require("../../redoc-lib"),OpenIDConnect_1=require("../../services/OpenIDConnect"),OAuth2Flow_1=require("./OAuth2Flow"),LinearProgress_1=require("../common/LinearProgress"),form_1=require("../common/form");function OpenIDConnect(e){var t,r=this,n=e.scheme,o=React.useState({}),a=o[0],c=o[1],l=React.useState(),i=l[0],s=l[1],u=React.useState(!1),m=u[0],p=u[1];React.useEffect((function(){_(n.openIdConnectUrl)}),[n.openIdConnectUrl]);var _=function(e){return tslib_1.__awaiter(r,void 0,void 0,(function(){var t,r;return tslib_1.__generator(this,(function(n){switch(n.label){case 0:p(!0),s(""),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OpenIDConnect_1.discoverOpenIDConnect(e)];case 2:return t=n.sent(),c(t),[3,4];case 3:return r=n.sent(),s(r.message),[3,4];case 4:return p(!1),[2]}}))}))};return React.createElement("div",null,m?React.createElement("div",null,React.createElement("div",null,"Fetching OpenID Connect metadata..."),React.createElement(LinearProgress_1.LinearProgress,null)):React.createElement("div",null,i?React.createElement(form_1.FormError,null,i):(null===(t=null==a?void 0:a.response_types_supported)||void 0===t?void 0:t.includes("token"))?React.createElement(React.Fragment,null,React.createElement(FlowName,null,"OAuth2 Implicit Flow"),React.createElement(OAuth2Flow_1.OAuth2Flow,{key:e.id,authorizationUrl:a.authorization_endpoint,authCorsProxyUrl:e.authCorsProxyUrl,scopes:a.scopes_supported,server:e.server,id:e.id,form:e.form,formApi:e.formApi,clientId:e.clientId,flow:"implicit"})):React.createElement("div",null,"Unsupported flow")))}exports.OpenIDConnect=OpenIDConnect;var templateObject_1,FlowName=redoc_lib_1.styled.div(templateObject_1||(templateObject_1=tslib_1.__makeTemplateObject(["\n  margin-top: 5px;\n  margin-bottom: 10px;\n"],["\n  margin-top: 5px;\n  margin-bottom: 10px;\n"])));
//# sourceMappingURL=OpenIDConnect.js.map