import{__spreadArrays}from"tslib";import*as React from"react";import{dottedString,get}from"../../utils";import{FormLabel,FormControl,FormWarning,GroupLabel,Table}from"../common/form";import{FormTextField}from"../common/TextField";import{ParameterEnumDropdown}from"./ParameterDropdown";export var SchemaType;!function(e){e.ARRAY="array",e.OBJECT="object"}(SchemaType||(SchemaType={}));var placeholder=function(e){return"("+e.schema.type+")"+(e.example?" "+e.example:"")};function safePush(e,a,r){e[a]||(e[a]=[]),e[a].push(r)}function orderParams(e){var a={};return e.forEach((function(e){safePush(a,e.in,e)})),a}var PARAM_PLACES=["path","query","cookie","header"];function createValidator(e){return function(a){if(e.required&&!a)return"Field is required";if(e.required&&e.schema.type===SchemaType.ARRAY&&Array.isArray(a)){if(a.length>(e.schema.rawSchema&&e.schema.rawSchema.maxItems||1/0))return"Too many items selected, maximum "+e.schema.rawSchema.maxItems;if(a.length<(e.schema.rawSchema&&e.schema.rawSchema.minItems||0)){var r=e.schema.rawSchema.minItems;return"You should select at least "+(1===r?r+" item":r+" items")}}}}function getInitialValue(e){if(e.schema.type===SchemaType.ARRAY){var a=e.schema.default||e.schema.example;if(!a&&e.schema.rawSchema.items){if(e.schema.rawSchema.items.default)return[e.schema.rawSchema.items.default];if(e.schema.rawSchema.items.example)return[e.schema.rawSchema.items.example]}return a||[]}return e.schema.default||e.schema.example}export function OperationParameters(e){function a(r,t,m){var n,c=m?dottedString(m,r.name):r.name,i=function(e){var a=e.oneOfType,r=e.type,t=e.items;return a||r===SchemaType.ARRAY&&(null==t?void 0:t.type)===SchemaType.OBJECT&&"Array of objects"}(r.schema);if(i&&console.warn('Unsupported parameter definition: "'+i+'"'),r.schema.type===SchemaType.OBJECT)return null===(n=r.schema.fields)||void 0===n?void 0:n.map((function(e){return a(e,t,c)}));var o=m?[t,m]:[r.in],l=dottedString.apply(void 0,__spreadArrays(o,[r.name]));return React.createElement(FormControl,{key:l},React.createElement(FormLabel,{required:r.required},c,":"),i?React.createElement(FormWarning,null,"Unsupported field schema definition"):function(a,r){var t=React.useMemo((function(){return createValidator(r)}),[r]),m=e.values,n=Array.isArray(r.schema.enum)&&r.schema.enum.length?r.schema.enum:void 0,c=getInitialValue(r);return n?React.createElement(FormControl,null,React.createElement(ParameterEnumDropdown,{initValue:c,paramEnum:n,field:a})):React.createElement(FormTextField,{fullWidth:!0,id:a,field:a,placeholder:placeholder(r),validate:t,initialValue:c||get(m,a),validateOnBlur:!0,validateOnChange:!0})}(l,r))}var r=orderParams(e.operation.parameters||[]);return React.createElement(Table,null,PARAM_PLACES.map((function(e){return function(e,r){return r&&r.length?React.createElement(React.Fragment,{key:e},React.createElement(FormControl,null,React.createElement(GroupLabel,null," # ",e," parameters "),React.createElement("span",null,"Â ")),r.map((function(r){return a(r,e)}))):null}(e,r[e])})))}
//# sourceMappingURL=OperationParameters.js.map