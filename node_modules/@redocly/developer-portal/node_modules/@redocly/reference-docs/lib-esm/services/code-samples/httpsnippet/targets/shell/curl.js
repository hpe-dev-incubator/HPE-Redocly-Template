import{__assign}from"tslib";import{format}from"util";import{CodeBuilder}from"../../helpers/code-builder";import shellHelpers from"../../helpers/shell";import{addIndentation,parseUrlIntoOperands}from"../../helpers/code-helpers";import{normalizeMimeType}from"../../../../utils";import{HTTPSnippet}from"../..";import{getParameterValue}from"../../../../../utils";function getUrl(e){var t=e.fullUrl,a=void 0===t?"":t,r=e.pathParameters;return parseUrlIntoOperands(a,void 0===r?{}:r).map((function(e){var t;return"variable"===e.type?null!==(t=getParameterValue("path",e.name))&&void 0!==t?t:":"+e.name:e.value})).join("")}var handler=function(e,t,a){var r,s,n=a.target,o=a.client,i=Object.assign({indent:"  ",short:!1,binary:!1},t),l=new CodeBuilder({indentation:i.indent,lineJoin:i.indent?" \\\n"+i.indent:" "}),p=(null===(r=e.securityOAuth2ExtraCalls)||void 0===r?void 0:r.length)?new HTTPSnippet(null===(s=e.securityOAuth2ExtraCalls)||void 0===s?void 0:s[0]).convert(n,o,__assign(__assign({},i),{withComments:!1})):"";if(l.push(0,"curl -i %s %s",i.short?"-X":"--request",e.method.toUpperCase()),e.basicAuth&&l.push(format("-u %s:%s",e.basicAuth.username,e.basicAuth.password)),l.push(format("%s%s",i.short?"":"--url ",shellHelpers.quote(getUrl(e)))),"HTTP/1.0"===e.httpVersion&&l.push(i.short?"-0":"--http1.0"),Object.keys(e.headersObj).sort().forEach((function(t){var a=format("%s: %s",t,e.headersObj[t]);l.push("%s %s",i.short?"-H":"--header",shellHelpers.quote(a))})),e.allHeaders.cookie&&l.push("%s %s",i.short?"-b":"--cookie",shellHelpers.quote(e.allHeaders.cookie)),e.postData)switch(normalizeMimeType(e.postData.mimeType)){case"multipart/form-data":e.postData.params.map((function(e){var t;t=e.fileName?format("%s=@%s",e.name,e.fileName):format("%s=%s",e.name,e.value),l.push("%s %s",i.short?"-F":"--form",shellHelpers.quote(t))}));break;case"application/x-www-form-urlencoded":e.postData.params?e.postData.params.map((function(e){l.push("%s %s",i.binary?"--data-binary":i.short?"-d":"--data",shellHelpers.quote(format("%s=%s",e.name,e.value)))})):l.push("%s %s",i.binary?"--data-binary":i.short?"-d":"--data",shellHelpers.quote(e.postData.text));break;case"application/json":e.postData.jsonObj&&l.push("%s %s",i.binary?"--data-binary":i.short?"-d":"--data",addIndentation(shellHelpers.quote(JSON.stringify(e.postData.jsonObj,null,i.indent)),{level:1,indent:i.indent,firstLine:!1}));break;default:e.postData.text&&l.push("%s %s",i.binary?"--data-binary":i.short?"-d":"--data",addIndentation(shellHelpers.quote(e.postData.text),{level:1,indent:i.indent,firstLine:!1}))}return(i.withComments?"# Requires curl >= 7.2\n\n":"")+(p?p+"\n\n"+l.join():l.join())};export var info={key:"curl",title:"curl",link:"http://curl.haxx.se/",description:"cURL is a command line tool and library for transferring data with URL syntax"};export default handler;
//# sourceMappingURL=curl.js.map